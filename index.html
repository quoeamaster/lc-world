<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.0"></script> <!-- vue -->

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> <!-- JQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script> <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script> <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.11/js/mdb.min.js"></script> <!-- MDB core JavaScript -->
    <script type="text/javascript" src="lib/magnificPopup.min.js"></script> <!-- magnific popup -->

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"> <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"> <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.11/css/mdb.min.css" rel="stylesheet"> <!-- Material Design Bootstrap -->
    <link href="lib/maginficPopup.css" rel="stylesheet"> <!-- magnific popup css -->

    <link href="style/common.css" rel="stylesheet">
</head>

<body>
    <div id="app" style="background: #fbfbfb;">
        <fixed-header></fixed-header>
        <!-- filler for the fixed-header above -->
        <div style="height: 80px;" >&nbsp;</div>

        <carousel v-bind:scrub="scrub['featured']"></carousel>

        <div style="height: 36px;" >&nbsp;</div>
        <portfolio-menu></portfolio-menu>
        <card-listing v-bind:listing="scrub['listing']"></card-listing>

        <about-me v-bind:about="scrub['about']"></about-me>
        <contact-me></contact-me>

        <!-- dummy-text v-bind:scrub="scrub"></dummy-text -->
    </div>

    <!-- import the vue components, THEN the app here -->
    <script type="text/javascript" src="component/contact.js"></script>
    <script type="text/javascript" src="component/about_me.js"></script>
    <script type="text/javascript" src="component/portfolio_menu.js"></script>
    <script type="text/javascript" src="component/fixed_header.js"></script>
    <script type="text/javascript" src="component/dummy_test.js"></script>
    <script type="text/javascript" src="component/carousel.js"></script>
    <script type="text/javascript" src="component/card.js"></script>
    <script type="text/javascript" src="component/app.js"></script>

    <script>
        // global event bus for event handling / receiving
        let eventBus = new Vue();
        window.eventBus = eventBus;

        window.onscroll = function() {
          applyStickToFixedHeader();
        };
        /**
         * add back the fixed header css if started scrolling
         */
        function applyStickToFixedHeader() {
          // fh-core (fixed header)
          if (window.pageYOffset > 20) {
            document.querySelector(".fh-core").classList.add('fh-rolling-background');
          } else {
            document.querySelector(".fh-core").classList.remove('fh-rolling-background');
          }
          // pmenu-core (category menu)
          let pmenuObj = document.querySelector(".pmenu-core");
          let pmenuOffset = 575;  // hard coded
          let a = document.querySelector(".cd-core-before");
          let endMenuOffsetY = a.clientHeight + pmenuOffset;
          // console.log('page y offset:', window.pageYOffset); console.log('clientHeight:', a.clientHeight);
          // console.log('offsetHeight:', a.offsetHeight); console.log('scrollHeight:', a.scrollHeight);
          if (pmenuObj) {
            // let pmenuObjOffsetTop = pmenuObj.offsetTop - 24;
            if (window.pageYOffset > pmenuOffset && window.pageYOffset < endMenuOffsetY) {
              pmenuObj.classList.add("pmenu-core-rolling-background");
            } else {
              pmenuObj.classList.remove("pmenu-core-rolling-background");
            }
          }

        }
    </script>
</body>
</html>
